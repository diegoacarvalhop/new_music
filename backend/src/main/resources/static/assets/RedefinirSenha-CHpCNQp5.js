import{r as a,j as e}from"./react-vendor-CQulTfZ0.js";import{c as v,a as N,L as l}from"./router-MSaW0Gl8.js";import{a as S}from"./axios-D5GkNzM3.js";import{g as b}from"./apiErrors-CU3vO3iu.js";/* empty css              */const L="/api";function k(){const[m]=v(),n=m.get("token")??"",h=N(),[i,g]=a.useState(""),[t,u]=a.useState(""),[o,s]=a.useState(""),[p,x]=a.useState(!1),[c,d]=a.useState(!1);a.useEffect(()=>{n.trim()||s("Link inválido. Solicite uma nova redefinição de senha.")},[n]);async function f(r){if(r.preventDefault(),s(""),i.length<6){s("A senha deve ter no mínimo 6 caracteres.");return}if(i!==t){s("As senhas não coincidem.");return}d(!0);try{await S.post(`${L}/auth/redefinir-senha`,{token:n,novaSenha:i}),x(!0),setTimeout(()=>h("/login",{replace:!0}),2e3)}catch(j){s(b(j).mensagem)}finally{d(!1)}}return n.trim()?p?e.jsx("div",{className:"login-page",children:e.jsxs("div",{className:"login-card",children:[e.jsxs("div",{className:"login-header",children:[e.jsx("img",{src:"/Logo%20Preto.png",alt:"NEW MUSIC",className:"login-logo"}),e.jsx("p",{children:"Senha alterada"})]}),e.jsx("div",{className:"login-form",children:e.jsx("div",{className:"alert alert-success",children:"Senha alterada com sucesso. Redirecionando para o login..."})})]})}):e.jsx("div",{className:"login-page",children:e.jsxs("div",{className:"login-card",children:[e.jsxs("div",{className:"login-header",children:[e.jsx("img",{src:"/Logo%20Preto.png",alt:"NEW MUSIC",className:"login-logo"}),e.jsx("p",{children:"Nova senha"})]}),e.jsxs("form",{onSubmit:f,className:"login-form",children:[o&&e.jsx("div",{className:"alert alert-error",children:o}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"novaSenha",children:"Nova senha *"}),e.jsx("input",{id:"novaSenha",type:"password",value:i,onChange:r=>g(r.target.value),required:!0,minLength:6,autoComplete:"new-password",placeholder:"Mínimo 6 caracteres"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"confirmarSenha",children:"Confirmar senha *"}),e.jsx("input",{id:"confirmarSenha",type:"password",value:t,onChange:r=>u(r.target.value),required:!0,minLength:6,autoComplete:"new-password",placeholder:"Repita a senha"})]}),e.jsx("button",{type:"submit",className:"btn btn-primary login-btn",disabled:c,children:c?"Salvando...":"Redefinir senha"}),e.jsx("p",{className:"login-footer",children:e.jsx(l,{to:"/login",children:"Voltar ao login"})})]})]})}):e.jsx("div",{className:"login-page",children:e.jsxs("div",{className:"login-card",children:[e.jsxs("div",{className:"login-header",children:[e.jsx("img",{src:"/Logo%20Preto.png",alt:"NEW MUSIC",className:"login-logo"}),e.jsx("p",{children:"Redefinir senha"})]}),e.jsxs("div",{className:"login-form",children:[e.jsx("div",{className:"alert alert-error",children:o}),e.jsxs("p",{className:"login-footer",children:[e.jsx(l,{to:"/esqueci-senha",children:"Solicitar novo link"})," · ",e.jsx(l,{to:"/login",children:"Voltar ao login"})]})]})]})})}export{k as default};
